<html>
<head>
</head>
<body>

<input type="text" id="input" />

<div id="output">

</div>

<script>

function isvowel(a) {
	if("aeiouAEIOU|".indexOf(a)!=-1)
		return true;

	return false;
}

function reduce2ndvowel(a, i, e) {
	var c = 0;

	for(var b = a.length - 1; b >= 0; b--) {
		if(isvowel(a[b])) {
			c++;
			if(c == 2 && a[b] != "I" && a[b] != "A" && a[b] != "u")
				a = a.substr(0, b) + "|" + a.substr(b + 1);
		}
	}

	c = 0;

	if(i == undefined)
		i = "a";

	if(e == undefined)
		e = "a";

	for(var b = a.length - 1; b >= 0; b--) {
		if(isvowel(a[b])) {
			c++;
			if(c == 3 && a[b] == "I")
				a = a.substr(0, b) + i + a.substr(b + 1);
			else if(c == 3 && a[b] == "E")
				a = a.substr(0, b) + e + a.substr(b + 1);
		}
	}

	return a;
}



function verbkind(a) {

}

function verb(v, p, n, g, a, ref, s) {
	var r = v.split("");

	if("uio".indexOf(r[1])==-1) {
		var vows = [ 
		[ ["","A","a","i","|","o"], ["ni","|","a","in|","A","E"] ],
		[ ["","i","E","|","a","E"], ["","u","a","|","u","a"] ],
		[ ["hi","|","I","a","|","I"], ["ha","|","a","A","|","a"] ],
		[ ["hit","a","E","i","a","E"], ["hit","a","E","i","a","E"] ]
		];

		if(s == undefined)
			s = 0;

		vows = vows[s][ref];

		if(s == 1)
			r[1] = r[1]+"|"+r[1];

		katab = vows[0]+r[0]+vows[1]+r[1]+vows[2]+r[2];
		ktab = vows[0]+r[0]+"|"+r[1]+vows[2]+r[2];
		ktob = vows[3]+r[0]+vows[4]+r[1]+vows[5]+r[2];

		var pforms = [ 
		[ [ katab+"|tI",katab+"|tI" ] ,  [katab+"|nu",katab+"|nu" ] ] ,
		[ [ katab+"|tA",katab+"|t|" ] ,   [ktab+"|tem",ktab+"|ten" ] ] ,
		[ [ katab+"",katab+"a" ] ,     [katab+"u",katab+"u" ] ] ,
		]

		var iforms = [ 
		[ [ "'"+ktob,"'"+ktob ] ,     ["n"+ktob,"n"+ktob ] ] ,
		[ [ "t"+ktob,"t"+ktob+"i" ] , ["t"+ktob+"u","t"+ktob+"|nAh" ] ] ,
		[ [ "y"+ktob,"t"+ktob ] ,     ["y"+ktob+"u","t"+ktob+"|nAh" ] ] ,
		]
	} else {
		var vows = [ 
		[ ["","A","a","A","|","o"], ["ni","|","a","in|","A","E"] ],
		[ ["","I","E","|","a","E"], ["","u","a","|","u","a"] ],
		[ ["hE","I","I","a","|","I"], ["hu","|","a","A","|","a"] ],
		[ ["hit","a","E","i","a","E"], ["hit","a","E","i","a","E"] ]
		];

		if(s == undefined)
			s = 0;

		vows = vows[s][ref];

		if(s == 1)
			r[1] = r[1]+"|"+r[1];

		katab = vows[0]+r[0]+vows[1]+r[2];
		ktab = vows[0]+r[0]+"|"+r[1]+vows[2]+r[2];
		ktob = vows[3]+r[0]+r[1]+r[2];
		ktob2 = "|"+r[0]+r[1]+r[2];

		var pforms = [ 
		[ [ katab+"|tI",katab+"|tI" ] ,  [katab+"|nu",katab+"|nu" ] ] ,
		[ [ katab+"|tA",katab+"|t|" ] ,   [katab+"|tem",katab+"|ten" ] ] ,
		[ [ katab+"",katab+"a" ] ,     [katab+"u",katab+"u" ] ] ,
		]

		var iforms = [ 
		[ [ "'"+ktob,"'"+ktob ] ,     ["n"+ktob,"n"+ktob ] ] ,
		[ [ "t"+ktob,"t"+ktob+"i" ] , ["t"+ktob+"u","t"+ktob2+"|nAh" ] ] ,
		[ [ "y"+ktob,"t"+ktob ] ,     ["y"+ktob+"u","t"+ktob2+"|nAh" ] ] ,
		]
	}

	if(a == 0)
		form = pforms[p][n][g];

	if(a == 1)
		form = iforms[p][n][g];

	if(form != katab) {
		if(s != 2)
			form = reduce2ndvowel(form);
	}

	form = form.replace(/^n\|[bcdfghjklmnpqrstvwxyz]/g, function(a) {
		return "n|"+a.charAt(2);
	});

	form = form.replace(/n\|[bcdfghjklmnpqrstvwxyz]/g, function(a) {
		return a.charAt(2)+"|"+a.charAt(2);
	});

	form = form.replace(/'i/g, function(a) {
		return "'e";
	});

	form = form.replace(/^[bcdfghjklmnpqrstvwxyz]\|/g, function(a) {
		return a.charAt(0)+"&#601;";
	});

	form = form.replace(/[bcdfghjklmnpqrstvwxyz]\|[bcdfghjklmnpqrstvwxyz]\|/g, function(a) {
		return a.charAt(0)+a.charAt(2)+"&#601;";
	});

	form = form.replace(/[AEIOU][bcdfghjklmnpqrstvwxyz]\|/g, function(a) {
		return a.charAt(0)+a.charAt(1)+"&#601;";
	});

	form = form.replace(/[AEIOU]/g, function(a) {
		return a.toLowerCase()+"&#772;";
	});

	form = form.replace(/\|/g, function(a) {
		return "";
	});

	return form;


}

function createtable(title, a, ref, s) {
	var output="";
	output+="<div class=\'stemgroup\' style=\'float:left;margin-right:20px\'>";
	output+="<h1>"+title+"</h1>";
	output+="<table>";
	output+="<tr><td>Person</td><td>Singular</td><td>Plural</td></tr>";
	output+="<tr><td>1st</td><td>"+verb(a,0,0,0,0,ref,s)+"</td><td>"+verb(a,0,1,0,0,ref,s)+"</td></tr>";
	output+="<tr><td>2nd</td><td>"+verb(a,1,0,0,0,ref,s)+"</td><td>"+verb(a,1,1,0,0,ref,s)+"</td></tr>";
	output+="<tr><td>2nd</td><td>"+verb(a,1,0,1,0,ref,s)+"</td><td>"+verb(a,1,1,1,0,ref,s)+"</td></tr>";
	output+="<tr><td>3rd</td><td>"+verb(a,2,0,0,0,ref,s)+"</td><td>"+verb(a,2,1,0,0,ref,s)+"</td></tr>";
	output+="<tr><td>3rd</td><td>"+verb(a,2,0,1,0,ref,s)+"</td><td>"+verb(a,2,1,1,0,ref,s)+"</td></tr>";
	output+="</table>";
	output+="<table>";
	output+="<tr><td>Person</td><td>Singular</td><td>Plural</td></tr>";
	output+="<tr><td>1st</td><td>"+verb(a,0,0,0,1,ref,s)+"</td><td>"+verb(a,0,1,0,1,ref,s)+"</td></tr>";
	output+="<tr><td>2nd</td><td>"+verb(a,1,0,0,1,ref,s)+"</td><td>"+verb(a,1,1,0,1,ref,s)+"</td></tr>";
	output+="<tr><td>2nd</td><td>"+verb(a,1,0,1,1,ref,s)+"</td><td>"+verb(a,1,1,1,1,ref,s)+"</td></tr>";
	output+="<tr><td>3rd</td><td>"+verb(a,2,0,0,1,ref,s)+"</td><td>"+verb(a,2,1,0,1,ref,s)+"</td></tr>";
	output+="<tr><td>3rd</td><td>"+verb(a,2,0,1,1,ref,s)+"</td><td>"+verb(a,2,1,1,1,ref,s)+"</td></tr>";
	output+="</table>";
	output+="</div>"
	return output;
}

document.getElementById("input").onkeyup = function(e) {
	var input = document.getElementById("input").value;
	var output="";

	var a;

	a=input;

	if(a.length<2)
		return;

	document.getElementById("output").innerHTML="";

	output+=createtable("Pagal", a, 0, 0);
	output+=createtable("Pigel", a, 0, 1);
	output+=createtable("Hipgil", a, 0, 2);
	output+=createtable("Hitpagel", a, 0, 3);
	output+=createtable("Hupgal", a, 1, 2);
	output+=createtable("Pugal", a, 1, 1);
	output+=createtable("Nipgal", a, 1, 0);

	document.getElementById("output").innerHTML=output;
}

</script>

</html>

